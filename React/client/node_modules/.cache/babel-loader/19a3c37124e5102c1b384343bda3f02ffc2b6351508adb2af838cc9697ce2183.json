{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/jjong/Desktop/React/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/jjong/Desktop/React/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/jjong/Desktop/React/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{useSelector}from\"react-redux\";import{useNavigate}from\"react-router-dom\";import Avatar from\"react-avatar\";import axios from\"axios\";import firebase from\"../../firebase.js\";import{MyPageDiv}from\"../../Style/UserCSS.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function MyPage(){var user=useSelector(function(state){return state.user;});var navigate=useNavigate();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),CurrentImage=_useState2[0],setCurrentImage=_useState2[1];useEffect(function(){if(user.isLoading&&!user.accessToken){navigate(\"/login\");}else{setCurrentImage(user.photoURL);}},[user]);var ImageUpload=function ImageUpload(e){var formData=new FormData();formData.append(\"file\",e.target.files[0]);axios.post(\"/api/user/profile/img\",formData).then(function(response){setCurrentImage(response.data.filePath);});};var SaveProfile=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var body;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();_context.prev=1;_context.next=4;return firebase.auth().currentUser.updateProfile({photoURL:CurrentImage});case 4:_context.next=9;break;case 6:_context.prev=6;_context.t0=_context[\"catch\"](1);return _context.abrupt(\"return\",alert(\"프로필 저장에 실패하였습니다.\"));case 9:body={photoURL:CurrentImage,uid:user.uid};axios.post(\"/api/user/profile/update\",body).then(function(response){if(response.data.success){alert(\"프로필 저장에 성공하였습니다.\");window.location.reload();}else{return alert(\"프로필 저장에 실패하였습니다.\");}});case 11:case\"end\":return _context.stop();}},_callee,null,[[1,6]]);}));return function SaveProfile(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(MyPageDiv,{style:{width:\"100vw\",height:\"100vh\"},children:/*#__PURE__*/_jsxs(\"form\",{style:{width:\"50%\",margin:\"0 auto\",display:\"flex\",flexDirection:\"column\",alignItems:\"center\",marginTop:\"2rem\"},children:[/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",style:{display:\"none\"},onChange:function onChange(e){return ImageUpload(e);}}),/*#__PURE__*/_jsx(Avatar,{size:\"100\",round:true,src:CurrentImage,style:{border:\"1px solid #c6c6c6\",cursor:\"pointer\"}})]}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){return SaveProfile(e);},children:\"\\uC800\\uC7A5\"})]})});}export default MyPage;","map":{"version":3,"names":["React","useState","useEffect","useSelector","useNavigate","Avatar","axios","firebase","MyPageDiv","jsx","_jsx","jsxs","_jsxs","MyPage","user","state","navigate","_useState","_useState2","_slicedToArray","CurrentImage","setCurrentImage","isLoading","accessToken","photoURL","ImageUpload","e","formData","FormData","append","target","files","post","then","response","data","filePath","SaveProfile","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","body","wrap","_callee$","_context","prev","next","preventDefault","auth","currentUser","updateProfile","t0","abrupt","alert","uid","success","window","location","reload","stop","_x","apply","arguments","style","width","height","children","margin","display","flexDirection","alignItems","marginTop","type","accept","onChange","size","round","src","border","cursor","onClick"],"sources":["C:/Users/jjong/Desktop/React/client/src/Component/User/MyPage.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport Avatar from \"react-avatar\";\r\nimport axios from \"axios\";\r\nimport firebase from \"../../firebase.js\";\r\nimport { MyPageDiv } from \"../../Style/UserCSS.js\";\r\n\r\nfunction MyPage() {\r\n  const user = useSelector((state) => state.user);\r\n  const navigate = useNavigate();\r\n\r\n  const [CurrentImage, setCurrentImage] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    if (user.isLoading && !user.accessToken) {\r\n      navigate(\"/login\");\r\n    } else {\r\n      setCurrentImage(user.photoURL);\r\n    }\r\n  }, [user]);\r\n\r\n  const ImageUpload = (e) => {\r\n    var formData = new FormData();\r\n    formData.append(\"file\", e.target.files[0]);\r\n    axios.post(\"/api/user/profile/img\", formData).then((response) => {\r\n      setCurrentImage(response.data.filePath);\r\n    });\r\n  };\r\n\r\n  const SaveProfile = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      await firebase.auth().currentUser.updateProfile({\r\n        photoURL: CurrentImage,\r\n      });\r\n    } catch (error) {\r\n      return alert(\"프로필 저장에 실패하였습니다.\");\r\n    }\r\n    let body = {\r\n      photoURL: CurrentImage,\r\n      uid: user.uid,\r\n    };\r\n    axios.post(\"/api/user/profile/update\", body).then((response) => {\r\n      if (response.data.success) {\r\n        alert(\"프로필 저장에 성공하였습니다.\");\r\n        window.location.reload();\r\n      } else {\r\n        return alert(\"프로필 저장에 실패하였습니다.\");\r\n      }\r\n    });\r\n  };\r\n\r\n  return (\r\n    <MyPageDiv style={{ width: \"100vw\", height: \"100vh\" }}>\r\n      <form\r\n        style={{\r\n          width: \"50%\",\r\n          margin: \"0 auto\",\r\n          display: \"flex\",\r\n          flexDirection: \"column\",\r\n          alignItems: \"center\",\r\n          marginTop: \"2rem\",\r\n        }}\r\n      >\r\n        <label>\r\n          <input\r\n            type=\"file\"\r\n            accept=\"image/*\"\r\n            style={{ display: \"none\" }}\r\n            onChange={(e) => ImageUpload(e)}\r\n          />\r\n          <Avatar\r\n            size=\"100\"\r\n            round={true}\r\n            src={CurrentImage}\r\n            style={{ border: \"1px solid #c6c6c6\", cursor: \"pointer\" }}\r\n          />\r\n        </label>\r\n        <button onClick={(e) => SaveProfile(e)}>저장</button>\r\n      </form>\r\n    </MyPageDiv>\r\n  );\r\n}\r\n\r\nexport default MyPage;\r\n"],"mappings":"2XAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,WAAW,KAAQ,aAAa,CACzC,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAO,CAAAC,MAAM,KAAM,cAAc,CACjC,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,QAAQ,KAAM,mBAAmB,CACxC,OAASC,SAAS,KAAQ,wBAAwB,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAEnD,QAAS,CAAAC,MAAMA,CAAA,CAAG,CAChB,GAAM,CAAAC,IAAI,CAAGX,WAAW,CAAC,SAACY,KAAK,QAAK,CAAAA,KAAK,CAACD,IAAI,GAAC,CAC/C,GAAM,CAAAE,QAAQ,CAAGZ,WAAW,EAAE,CAE9B,IAAAa,SAAA,CAAwChB,QAAQ,CAAC,EAAE,CAAC,CAAAiB,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAA7CG,YAAY,CAAAF,UAAA,IAAEG,eAAe,CAAAH,UAAA,IAEpChB,SAAS,CAAC,UAAM,CACd,GAAIY,IAAI,CAACQ,SAAS,EAAI,CAACR,IAAI,CAACS,WAAW,CAAE,CACvCP,QAAQ,CAAC,QAAQ,CAAC,CACpB,CAAC,IAAM,CACLK,eAAe,CAACP,IAAI,CAACU,QAAQ,CAAC,CAChC,CACF,CAAC,CAAE,CAACV,IAAI,CAAC,CAAC,CAEV,GAAM,CAAAW,WAAW,CAAG,QAAd,CAAAA,WAAWA,CAAIC,CAAC,CAAK,CACzB,GAAI,CAAAC,QAAQ,CAAG,GAAI,CAAAC,QAAQ,EAAE,CAC7BD,QAAQ,CAACE,MAAM,CAAC,MAAM,CAAEH,CAAC,CAACI,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC,CAC1CzB,KAAK,CAAC0B,IAAI,CAAC,uBAAuB,CAAEL,QAAQ,CAAC,CAACM,IAAI,CAAC,SAACC,QAAQ,CAAK,CAC/Db,eAAe,CAACa,QAAQ,CAACC,IAAI,CAACC,QAAQ,CAAC,CACzC,CAAC,CAAC,CACJ,CAAC,CAED,GAAM,CAAAC,WAAW,6BAAAC,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAAOhB,CAAC,MAAAiB,IAAA,QAAAH,mBAAA,GAAAI,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAC1BtB,CAAC,CAACuB,cAAc,EAAE,CAACH,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA,SAEX,CAAAzC,QAAQ,CAAC2C,IAAI,EAAE,CAACC,WAAW,CAACC,aAAa,CAAC,CAC9C5B,QAAQ,CAAEJ,YACZ,CAAC,CAAC,QAAA0B,QAAA,CAAAE,IAAA,gBAAAF,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAO,EAAA,CAAAP,QAAA,oBAAAA,QAAA,CAAAQ,MAAA,UAEKC,KAAK,CAAC,kBAAkB,CAAC,SAE9BZ,IAAI,CAAG,CACTnB,QAAQ,CAAEJ,YAAY,CACtBoC,GAAG,CAAE1C,IAAI,CAAC0C,GACZ,CAAC,CACDlD,KAAK,CAAC0B,IAAI,CAAC,0BAA0B,CAAEW,IAAI,CAAC,CAACV,IAAI,CAAC,SAACC,QAAQ,CAAK,CAC9D,GAAIA,QAAQ,CAACC,IAAI,CAACsB,OAAO,CAAE,CACzBF,KAAK,CAAC,kBAAkB,CAAC,CACzBG,MAAM,CAACC,QAAQ,CAACC,MAAM,EAAE,CAC1B,CAAC,IAAM,CACL,MAAO,CAAAL,KAAK,CAAC,kBAAkB,CAAC,CAClC,CACF,CAAC,CAAC,CAAC,yBAAAT,QAAA,CAAAe,IAAA,MAAAnB,OAAA,gBACJ,kBArBK,CAAAL,WAAWA,CAAAyB,EAAA,SAAAxB,IAAA,CAAAyB,KAAA,MAAAC,SAAA,OAqBhB,CAED,mBACEtD,IAAA,CAACF,SAAS,EAACyD,KAAK,CAAE,CAAEC,KAAK,CAAE,OAAO,CAAEC,MAAM,CAAE,OAAQ,CAAE,CAAAC,QAAA,cACpDxD,KAAA,SACEqD,KAAK,CAAE,CACLC,KAAK,CAAE,KAAK,CACZG,MAAM,CAAE,QAAQ,CAChBC,OAAO,CAAE,MAAM,CACfC,aAAa,CAAE,QAAQ,CACvBC,UAAU,CAAE,QAAQ,CACpBC,SAAS,CAAE,MACb,CAAE,CAAAL,QAAA,eAEFxD,KAAA,UAAAwD,QAAA,eACE1D,IAAA,UACEgE,IAAI,CAAC,MAAM,CACXC,MAAM,CAAC,SAAS,CAChBV,KAAK,CAAE,CAAEK,OAAO,CAAE,MAAO,CAAE,CAC3BM,QAAQ,CAAE,SAAAA,SAAClD,CAAC,QAAK,CAAAD,WAAW,CAACC,CAAC,CAAC,EAAC,EAChC,cACFhB,IAAA,CAACL,MAAM,EACLwE,IAAI,CAAC,KAAK,CACVC,KAAK,CAAE,IAAK,CACZC,GAAG,CAAE3D,YAAa,CAClB6C,KAAK,CAAE,CAAEe,MAAM,CAAE,mBAAmB,CAAEC,MAAM,CAAE,SAAU,CAAE,EAC1D,GACI,cACRvE,IAAA,WAAQwE,OAAO,CAAE,SAAAA,QAACxD,CAAC,QAAK,CAAAW,WAAW,CAACX,CAAC,CAAC,EAAC,CAAA0C,QAAA,CAAC,cAAE,EAAS,GAC9C,EACG,CAEhB,CAEA,cAAe,CAAAvD,MAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}