{"ast":null,"code":"import _slicedToArray from\"C:/Users/jjong/Desktop/React/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useRef}from\"react\";import{RepleContentDiv,RepleUploadDiv}from\"../../Style/RepleCSS.js\";import{useSelector}from\"react-redux\";import Avatar from\"react-avatar\";import axios from\"axios\";import moment from\"moment\";import\"moment/locale/en-nz\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function RepleContent(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),ModalFlag=_useState2[0],setModalFlag=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),EdifFlag=_useState4[0],setEdifFlag=_useState4[1];var _useState5=useState(props.reple.reple),_useState6=_slicedToArray(_useState5,2),Reple=_useState6[0],setReple=_useState6[1];var user=useSelector(function(state){return state.user;});var ref=useRef();useOnClickOutside(ref,function(){return setModalFlag(false);});var SetTime=function SetTime(a,b){if(a!==b){return moment(b).format(\"Do MMMM YYYY, hh:mm\")+\"(edited)\";}else{return moment(a).format(\"Do MMMM YYYY, hh:mm\");}};var SubmitHandler=function SubmitHandler(e){e.preventDefault();var body={uid:user.uid,reple:Reple,postId:props.reple.postId,repleId:props.reple._id};axios.post(\"/api/reple/edit\",body).then(function(response){if(response.data.success){alert(\"Comment edit was successful.\");}else{alert(\"Comment editing failed.\");}return window.location.reload();});};var DeleteHandler=function DeleteHandler(e){e.preventDefault();if(window.confirm(\"Are you sure you want to delete it?\")){var body={repleId:props.reple._id,postId:props.reple.postId};axios.post(\"/api/reple/delete\",body).then(function(response){if(response.data.success){alert(\"Your comment has been deleted.\");window.location.reload();}}).catch(function(err){alert(\"Your comment failed to be deleted.\");});}};return/*#__PURE__*/_jsxs(RepleContentDiv,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"author\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"userInfo\",children:[/*#__PURE__*/_jsx(Avatar,{size:\"30\",round:true,src:props.reple.author.photoURL,style:{border:\"1px solid #c6c6c6\"}}),/*#__PURE__*/_jsx(\"p\",{children:props.reple.author.displayName})]}),props.reple.author.uid===user.uid&&/*#__PURE__*/_jsxs(\"div\",{className:\"modalControl\",children:[/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return setModalFlag(true);},children:\"\\xB7\\xB7\\xB7\"}),ModalFlag&&/*#__PURE__*/_jsxs(\"div\",{className:\"modalDiv\",ref:ref,children:[/*#__PURE__*/_jsx(\"p\",{onClick:function onClick(){setEdifFlag(true);setModalFlag(false);},children:\"Edit\"}),/*#__PURE__*/_jsx(\"p\",{className:\"delete\",onClick:function onClick(e){return DeleteHandler(e);},children:\"Delete\"})]})]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"time\",children:SetTime(props.reple.createdAt,props.reple.updatedAt)}),EdifFlag?/*#__PURE__*/_jsxs(RepleUploadDiv,{children:[/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:Reple,onChange:function onChange(e){setReple(e.currentTarget.value);}}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){SubmitHandler(e);},children:\"Submit\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"cancel\",children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){e.preventDefault();setEdifFlag(false);},children:\"Cancel\"})})]}):/*#__PURE__*/_jsx(\"p\",{children:props.reple.reple})]});}function useOnClickOutside(ref,handler){useEffect(function(){var listener=function listener(event){if(!ref.current||ref.current.contains(event.target)){return;}handler(event);};document.addEventListener(\"mousedown\",listener);document.addEventListener(\"touchstart\",listener);return function(){document.removeEventListener(\"mousedown\",listener);document.removeEventListener(\"touchstart\",listener);};},[ref,handler]);}export default RepleContent;","map":{"version":3,"names":["React","useState","useEffect","useRef","RepleContentDiv","RepleUploadDiv","useSelector","Avatar","axios","moment","jsx","_jsx","jsxs","_jsxs","RepleContent","props","_useState","_useState2","_slicedToArray","ModalFlag","setModalFlag","_useState3","_useState4","EdifFlag","setEdifFlag","_useState5","reple","_useState6","Reple","setReple","user","state","ref","useOnClickOutside","SetTime","a","b","format","SubmitHandler","e","preventDefault","body","uid","postId","repleId","_id","post","then","response","data","success","alert","window","location","reload","DeleteHandler","confirm","catch","err","children","className","size","round","src","author","photoURL","style","border","displayName","onClick","createdAt","updatedAt","type","value","onChange","currentTarget","handler","listener","event","current","contains","target","document","addEventListener","removeEventListener"],"sources":["C:/Users/jjong/Desktop/React/client/src/Component/Reple/RepleContent.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\nimport { RepleContentDiv, RepleUploadDiv } from \"../../Style/RepleCSS.js\";\r\nimport { useSelector } from \"react-redux\";\r\nimport Avatar from \"react-avatar\";\r\n\r\nimport axios from \"axios\";\r\nimport moment from \"moment\";\r\nimport \"moment/locale/en-nz\";\r\n\r\nfunction RepleContent(props) {\r\n  const [ModalFlag, setModalFlag] = useState(false);\r\n  const [EdifFlag, setEdifFlag] = useState(false);\r\n  const [Reple, setReple] = useState(props.reple.reple);\r\n\r\n  const user = useSelector((state) => state.user);\r\n  const ref = useRef();\r\n  useOnClickOutside(ref, () => setModalFlag(false));\r\n\r\n  const SetTime = (a, b) => {\r\n    if (a !== b) {\r\n      return moment(b).format(\"Do MMMM YYYY, hh:mm\") + \"(edited)\";\r\n    } else {\r\n      return moment(a).format(\"Do MMMM YYYY, hh:mm\");\r\n    }\r\n  };\r\n\r\n  const SubmitHandler = (e) => {\r\n    e.preventDefault();\r\n    let body = {\r\n      uid: user.uid,\r\n      reple: Reple,\r\n      postId: props.reple.postId,\r\n      repleId: props.reple._id,\r\n    };\r\n\r\n    axios.post(\"/api/reple/edit\", body).then((response) => {\r\n      if (response.data.success) {\r\n        alert(\"Comment edit was successful.\");\r\n      } else {\r\n        alert(\"Comment editing failed.\");\r\n      }\r\n      return window.location.reload();\r\n    });\r\n  };\r\n\r\n  const DeleteHandler = (e) => {\r\n    e.preventDefault();\r\n    if (window.confirm(\"Are you sure you want to delete it?\")) {\r\n      let body = {\r\n        repleId: props.reple._id,\r\n        postId: props.reple.postId,\r\n      };\r\n      axios\r\n        .post(\"/api/reple/delete\", body)\r\n        .then((response) => {\r\n          if (response.data.success) {\r\n            alert(\"Your comment has been deleted.\");\r\n            window.location.reload();\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          alert(\"Your comment failed to be deleted.\");\r\n        });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <RepleContentDiv>\r\n      <div className=\"author\">\r\n        <div className=\"userInfo\">\r\n          <Avatar\r\n            size=\"30\"\r\n            round={true}\r\n            src={props.reple.author.photoURL}\r\n            style={{ border: \"1px solid #c6c6c6\" }}\r\n          />\r\n          <p>{props.reple.author.displayName}</p>\r\n        </div>\r\n        {props.reple.author.uid === user.uid && (\r\n          <div className=\"modalControl\">\r\n            <span onClick={() => setModalFlag(true)}>···</span>\r\n            {ModalFlag && (\r\n              <div className=\"modalDiv\" ref={ref}>\r\n                <p\r\n                  onClick={() => {\r\n                    setEdifFlag(true);\r\n                    setModalFlag(false);\r\n                  }}\r\n                >\r\n                  Edit\r\n                </p>\r\n                <p className=\"delete\" onClick={(e) => DeleteHandler(e)}>\r\n                  Delete\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n      <p className=\"time\">\r\n        {SetTime(props.reple.createdAt, props.reple.updatedAt)}\r\n      </p>\r\n      {EdifFlag ? (\r\n        <RepleUploadDiv>\r\n          <form>\r\n            <input\r\n              type=\"text\"\r\n              value={Reple}\r\n              onChange={(e) => {\r\n                setReple(e.currentTarget.value);\r\n              }}\r\n            />\r\n            <button\r\n              onClick={(e) => {\r\n                SubmitHandler(e);\r\n              }}\r\n            >\r\n              Submit\r\n            </button>\r\n          </form>\r\n          <div className=\"cancel\">\r\n            <button\r\n              onClick={(e) => {\r\n                e.preventDefault();\r\n                setEdifFlag(false);\r\n              }}\r\n            >\r\n              Cancel\r\n            </button>\r\n          </div>\r\n        </RepleUploadDiv>\r\n      ) : (\r\n        <p>{props.reple.reple}</p>\r\n      )}\r\n    </RepleContentDiv>\r\n  );\r\n}\r\n\r\nfunction useOnClickOutside(ref, handler) {\r\n  useEffect(() => {\r\n    const listener = (event) => {\r\n      if (!ref.current || ref.current.contains(event.target)) {\r\n        return;\r\n      }\r\n      handler(event);\r\n    };\r\n    document.addEventListener(\"mousedown\", listener);\r\n    document.addEventListener(\"touchstart\", listener);\r\n    return () => {\r\n      document.removeEventListener(\"mousedown\", listener);\r\n      document.removeEventListener(\"touchstart\", listener);\r\n    };\r\n  }, [ref, handler]);\r\n}\r\n\r\nexport default RepleContent;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}